# Muscle Load Summary — кто получает нагрузку

## Зачем это нужно
- Быстро понять, какие мышцы и группы получают больше всего работы.
- Увидеть перекос: например, если постоянно прокачиваются только грудь и руки, а спина отдыхает.
- Отличить «стимул» (условная “нагрузка от работы”) от «тоннажа» (вес × повторы), чтобы учитывать разные стили тренировок.
- Учитывать, что одинаковые “100×5” в разных упражнениях ощущаются по-разному: многосуставные движения обычно “съедают” больше ресурса.
- Учитывать, что разные мышцы по-разному “устают” при одинаковой работе (маленькие/капризные чаще набирают усталость быстрее).

## Источники данных
- Каждая тренировка → список упражнений → список сетов (iterations).
- У упражнения есть набор мышц с процентами (bundles). Эти проценты показывают, какая часть работы уходит в каждую мышцу.
- Для каждой мышцы теперь есть дополнительные параметры:
    - **size** (0..1) — “ёмкость” мышцы: чем больше muscle, тем больше “резерв” и тем медленнее она набирает усталость при той же работе.
    - **sensitivity** (0..1) — “чувствительность”: чем выше, тем быстрее мышца набирает усталость при той же работе.
- Для сетов считаем:
    - **Stimulus** — сумма “повторов с усилением от веса”. Даже если подходы одинаковые по повторам, большой вес поднимет stimulus выше.
    - **Volume** — вес × повторы. Классический тоннаж, полезен для силовых и прогрессии объёма.

## Как рассчитываем
1. **Собираем упражнения** (из одной тренировки или списка тренировок).
2. **Подгружаем примеры упражнений** (ExerciseExample), чтобы получить bundles (мышцы + проценты).
3. **Подгружаем группы мышц** (MuscleGroup), чтобы строить отчёт и по группам, и по отдельным мышцам.
4. **Считаем базовую нагрузку упражнения:**
    - **Stimulus**: для каждого сета берём `reps` и умножаем на небольшой “бонус за вес”.  
      Идея: одинаковые повторы с большим весом — это больше реальной нагрузки.
    - **Volume**: для каждого сета берём `weight * reps` и суммируем.
5. **Добавляем бонус за “сложность упражнения” (только для stimulus):**
    - Если упражнение реально задействует несколько мышц (не одна доминирует), стимул чуть увеличивается.
    - Это делает так, чтобы многосуставные упражнения “весили” больше по стимулу, чем изолирующие, даже при похожих цифрах в журнале.
6. **Распределяем нагрузку упражнения по мышцам:**
    - Берём проценты bundles.
    - Делим нагрузку пропорционально этим процентам.
7. **Применяем поправку на “усталость мышцы” (только для stimulus):**
    - Для каждой мышцы вычисляется множитель из её `size` и `sensitivity`.
    - Логика простая:
        - больше `size` → мышца “держит” больше работы (меньше усталости на ту же работу)
        - больше `sensitivity` → быстрее “забивается” (больше усталости на ту же работу)
    - После этого одинаковый вклад в упражнении может давать разную “усталость” для разных мышц.
8. **Суммируем вклад всех упражнений**:
    - Получаем итоговую карту `MuscleEnum -> Float` отдельно для stimulus и отдельно для volume.
9. **Строим отчёты:**
    - **perMuscle**: каждая мышца получает процент от самой нагруженной мышцы (у лидера будет 100%).
    - **perGroup**: суммируем по группам и показываем долю группы от общего (в процентах).
    - То же самое для volume.
10. **Считаем dominance** (по stimulus):
- `top1SharePercent` — сколько забирает самая нагруженная мышца от общего.
- `top2SharePercent` — сколько забирают две самые нагруженные вместе.

## Как читать результат
- `perMuscle` — список мышц с процентами stimulus (нормализовано по лидеру: 100% = самая нагруженная).
- `perGroup` — распределение stimulus по группам (в процентах от общей суммы).
- `volumePerMuscle` — мышцы по тоннажу, нормализовано по лидеру.
- `volumePerGroup` — группы по тоннажу (в процентах от общей суммы).
- `dominance.top1SharePercent`:
    - высокий показатель → почти всё уходит в одну мышцу (типично для изоляции).
    - низкий показатель → нагрузка распределена более равномерно (часто у базовых движений).

## Примеры сценариев
- **Новичок без точных весов.**
    - Если веса пустые/нулевые, volume будет низким или пустым, но stimulus всё равно покажет картину по повторам.
    - Даже при минимальных весах стимул остаётся полезным: он покажет, что тренировка была “про работу”, а не про тоннаж.
- **Любитель силовых.**
    - Volume даёт строгую картину прогрессии: можно увидеть, что ноги отстают по тоннажу относительно спины/груди.
    - Stimulus при этом покажет “усталость” более похоже на ощущения (база + сложность + вес).
- **Спортсмен после травмы плеча.**
    - Благодаря `sensitivity` плечо (дельты) может “перегружаться” быстрее в расчёте, даже если тоннаж не кажется большим.
    - Если `dominance.top1` вырос и в топах постоянно плечи/трицепс — это сигнал, что восстановление не успевает за нагрузкой и стоит перераспределить упражнения (например, добавить тяги/стабилизацию, снизить долю жимовых).
