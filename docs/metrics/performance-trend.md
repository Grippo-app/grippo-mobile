# Performance Trend — карточки “лучше, хуже или стабильно”

## Что это и когда мы показываем
- Пять карточек: Volume (объем), Repetitions (повторы), Intensity (средний вес), Density (работа за минуту) и Duration (длительность).
- Каждая карточка проговаривает простое состояние: «Improved», «Declined», «Stable» или «Record».
- Если у пользователя нет заполненного опыта, карточки не строим: без этой информации непонятно, насколько тонко реагировать.

## Какие данные нужны
- Список тренировок в хронологическом порядке. Достаточно последних 6–10 сессий, но можно и длиннее.
- Поля от клиента: `volume`, `repetitions`, `intensity`, `duration`.
- Density считаем сами: объем делим на длительность, чтобы понять, сколько работы делается за минуту.

## Как опыт (стаж) влияет на чувствительность

`ExperienceEnum` = стаж занятий в зале:
- `BEGINNER` — до года;
- `INTERMEDIATE` — 1–3 года;
- `ADVANCED` — 3–5 лет;
- `PRO` — 5+ лет осознанных тренировок.

| Experience | Что считаем «заметным» | Как это ощущается пользователю |
| --- | --- | --- |
| `BEGINNER` | Нужно минимум ~6 % роста/падения | Новичкам показываем изменения только если они явно выбиваются из привычных значений. |
| `INTERMEDIATE` | Порог около 4 % | Среднему уровню уже интересны средние колебания. |
| `ADVANCED` | Порог около 3 % | Продвинутые замечают небольшие улучшения. |
| `PRO` | Порог около 2 % | Профессионалам показываем даже мелкие сдвиги. |

Чем опыт выше, тем раньше карточка переключается в «Improved» или «Declined». Для всех одно правило: если последняя тренировка почти догнала лучший результат в списке, статус меняется на «Record». Карточка Duration всегда «Stable» — длиннее тренировка не значит лучше.

## Простая схема принятия решения
1. Берем все тренировки кроме последней и считаем их «обычным уровнем».
2. Сравниваем весь ряд значений с этим уровнем и понимаем, растет ли тенденция или падает.
3. Для каждого показателя считаем «текущий», «средний» и «лучший» значения.
4. Сравниваем амплитуду изменений с порогом из таблицы выше. Если она меньше, показываем «Stable», если больше — «Improved» или «Declined».
5. Если нет хотя бы двух осмысленных точек, карточка скрывается.

## Как читать карточку
- `current` — последняя тренировка.
- `average` — средний уровень до нее, оттенок «что обычно происходит».
- `best` — лучший показатель в текущем списке.
- `deltaPercentage` — знак направления: положительное число = рост, отрицательное = спад.
- `status` — `Improved`, `Declined`, `Stable` или `Record`.

## Сценарии по опыту
- **Начинающий Алекс.** За три недели Алекс делал то густо, то пусто. Карточка Volume покажет «Improved» только если объем вырос заметно и держится, а не из-за разовой вспышки. Если Алекс пропустит неделю, статус быстро сменится на «Declined» — так легче подталкивать его вернуться.
- **Средний уровень Даша.** Даша тренируется 3–4 раза в неделю. Объем примерно одинаковый, зато стала делать больше подходов и короче отдыхает. Карточка Density уходит в «Improved», потому что мы видим последовательный рост, а порог чувствительности уже ниже, чем у новичков.
- **Продвинутый Илья.** Илья готовится к старту: нагрузку снижает, но старается удерживать интенсивность. Объем падает, потому что это часть плана, и карточка честно показывает «Declined». Зато Intensity остается «Stable», что подтверждает: он убавил только общий тоннаж.
- **Про-уровень Марина.** Марина после сбора делает короткие, но насыщенные тренировки. Любое небольшое улучшение в Intensity или Density мы фиксируем почти сразу — порог низкий. Она быстро видит «Improved» и понимает, что пиковая форма набирается.

## Диалог с продуктом
- Если карточки пустые — проверьте, что у пользователя задан опыт.
- Хотите усилить мотивацию новичков? Подайте в ленту только Volume и Repetitions, потому что именно они быстрее реагируют на большие шаги.
- Нужен более спокойный тон? Скрывайте `deltaPercentage` и оставляйте только текстовый статус.*** End Patch
